// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Menu {
  id                    String   @id @default(auto()) @map("_id") @db.ObjectId
  foodName              String   
  category              String
  description           String?   
  imageUrl              String
  price                 Int
  isAvailable           menu_status   @default(NORMAL)
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @default(now())
  restaurant            Restaurant  @relation(fields: [restaurantId], references: [id])
  restaurantId          String  @db.ObjectId
  @@unique([restaurantId,foodName])
  @@unique([restaurantId, id])
}

model Restaurant {
  id                    String   @id @default(auto()) @map("_id") @db.ObjectId
  restaurantName        String   @unique
  menu                  Menu[]
  location              String
  registerOn            DateTime      @default(now())
  isActivate            Boolean  @default(true)
  status                restaurant_status  @default(OPEN)
  qrcode                Qrcode[]
  admin                 Admin[] @relation("AdminRestaurant")
  updatedAt             DateTime  @default(now())
  updatedBy             Admin?  @relation("AdminUpdate")

}

model Qrcode {
  id                    String   @id @default(auto()) @map("_id") @db.ObjectId
  tableToken            String   @unique
  tableName             String  
  qrcodeImageUrl        String
  isActivate            Boolean  @default(true)
  restaurant            Restaurant   @relation(fields: [restaurantId], references: [id])
  restaurantId          String   @db.ObjectId
  @@unique([tableName,restaurantId])
}

model Admin {
  id                    String   @id @default(auto()) @map("_id") @db.ObjectId
  email                 String   @unique
  password              String
  restaurant            Restaurant?   @relation("AdminRestaurant" ,fields: [restaurantId], references: [id])
  restaurantId          String?   @db.ObjectId
  updateRestaurant      Restaurant?   @relation("AdminUpdate", fields: [updateRestaurantId], references: [id])
  updateRestaurantId    String?   @db.ObjectId
}

enum menu_status {
  NORMAL
  CANCEL
}

enum restaurant_status {
  OPEN
  CLOSE
}